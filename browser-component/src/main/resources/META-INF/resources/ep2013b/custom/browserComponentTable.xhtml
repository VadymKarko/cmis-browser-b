<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:cc="http://xmlns.jcp.org/jsf/composite"
                xmlns:p="http://primefaces.org/ui"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:custom="http://java.sun.com/jsf/composite/ep2013b/custom">

<cc:interface componentType="browserComponentTable">
    <cc:attribute name="link"/>
</cc:interface>

<cc:implementation>

    <p:layout id="tablelayout" rendered="#{cc.renderComponent}">
    <p:layoutUnit position="center" >
    <!-- Simple Search -->
    <p:panel>
        <h:panelGrid columns="3">
            <p:column>
                <p:inputText id="searchInput" value="#{cc.searchCriteria}"/>
            </p:column>

            <p:column>
                <p:commandButton id="searchbtn" action="#{cc.simple}" update="table" icon="ui-icon-search" title="Search">
                    <f:param name="folderId" value="#{cc.folderId}"/>
                </p:commandButton>
            </p:column>

            <p:column>
                <p:ajaxStatus>
                    <f:facet name="start">
                        <h:outputText value="processing..."/>
                    </f:facet>

                    <f:facet name="complete">
                        <h:outputText value="" />
                    </f:facet>
                </p:ajaxStatus>
            </p:column>

            <!-- button : "New Folder"-->
            <p:commandButton id="createfolder" action="#{cc.newFolder}" value="New Folder" update = "@all" title="Create New Folder">
                <f:param name ="folderId" value="#{cc.folderId}" />
            </p:commandButton>

        </h:panelGrid>
    </p:panel>

    <!-- Advanced Search -->
    <p:accordionPanel activeIndex="-1">
        <p:tab title="Advanced Search">
        <!--<p:panel id="advancedSearch" toggleable="true" header="Advanced Search">-->
        <h:panelGrid columns="2">
            <h:outputLabel value="Document type:"/>
            <!-- WARNING: Should be PrimeFace component <p:selectOneMenu>,
                          but it sets itemLabel to documentType instead of itemValue-->
            <h:selectOneMenu id="searchDocumentType" value="#{cc.advancedSearchParams.documentType}">
                <f:selectItem itemLabel="" itemValue=""/>
                <f:selectItem itemLabel="Document" itemValue="cmis:document"/>
                <f:selectItem itemLabel="Folder" itemValue="cmis:folder"/>
            </h:selectOneMenu>

            <h:outputLabel value="Date from:"/>
            <p:calendar id="searchDateFrom" showOn="button" value="#{cc.advancedSearchParams.dateFrom}"/>

            <h:outputLabel value="Date to:"/>
            <p:calendar id="searchDateTo" showOn="button" value="#{cc.advancedSearchParams.dateTo}"/>

            <h:outputLabel value="Content type:"/>
            <h:selectOneMenu id="searchContentType" value="#{cc.advancedSearchParams.contentType}">
                <f:selectItem itemLabel="" itemValue=""/>
                <f:selectItem itemLabel="Complex Type" itemValue="ComplexType" />
            </h:selectOneMenu>

            <h:outputLabel value="Size (B):"/>
            <p:spinner id="searchSize" value="#{cc.advancedSearchParams.size}"/>

            <h:outputLabel value="Text in content:"/>
            <p:inputText id="searchText" value="#{cc.advancedSearchParams.text}"/>
        </h:panelGrid>
    <!--</p:panel>-->
        </p:tab>
    </p:accordionPanel>

    <!-- Table Panel-->
    <p:panel>
        <p:dataTable var="item" value="#{cc.dataList}"  id="table" >
            <p:column headerText="Id">
                <h:outputText value="#{item.id}"  id="itemid" />
            </p:column>

            <p:column headerText="Name">
                <h:outputText value="#{item.name}" id="itemname" />


                <!-- button : "Edit button"-->
                <p:button id="editfolder" value="Edit" update = "table" ajax="false"  title="Create New Folder" rendered="true" >
                    <f:param name ="folderId" value="#{cc.folderId}" />

                </p:button>

                <!-- button: Delete-->
                <p:button id="deletefolder" value="Delete" update = "table" ajax="false"  title="Create New Folder" rendered="true" >
                    <f:param name ="folderId" value="#{cc.folderId}" />
                </p:button>
            </p:column>

            <p:column headerText="Type">
                <h:outputText value="#{item.type}" id="itemtype" />
            </p:column>

            <!-- Paging Panel-->
            <f:facet name="footer">
                <p:commandButton id="butfirst" action="#{cc.firstPage}" disabled="#{!cc.prevAllowed}" update="table" icon="ui-icon-arrowthickstop-1-w">
                    <f:param name="folderId" value="#{cc.folderId}"/>
                </p:commandButton>

                <p:commandButton id="butprev" action="#{cc.prevPage}" disabled="#{!cc.prevAllowed}" update="table" icon="ui-icon-arrowthick-1-w">
                    <f:param name="folderId" value="#{cc.folderId}"/>
                </p:commandButton>

                <p:commandButton id="butnext" action="#{cc.nextPage}" disabled="#{!cc.nextAllowed}" update="table" icon="ui-icon-arrowthick-1-e">
                    <f:param name="folderId" value="#{cc.folderId}"/>
                </p:commandButton>

                <p:commandButton id="butlast" action="#{cc.lastPage}" disabled="#{!cc.nextAllowed}" update="table" icon="ui-icon-arrowthickstop-1-e">
                    <f:param name="folderId" value="#{cc.folderId}"/>
                </p:commandButton>
            </f:facet>
        </p:dataTable>
    </p:panel>
    </p:layoutUnit>
    </p:layout>

    <p:layout id="buttonlayout" rendered="#{!cc.renderComponent}">
        <p:layoutUnit position="center">

            <p:panel id="panel" style="margin-bottom:10px;">
                <h:panelGrid columns="2">
                    <h:outputLabel for="namefolder" value="Name:*"/>
                    <p:inputText id="namefolder" required="true" label="Name" value="#{cc.newFolderItem.name}"/>


                    <h:outputLabel for="type" value="Type:* "/>
                    <h:selectOneMenu id="type" value="#{cc.newFolderItem.type}">
                        <f:selectItem itemLabel="Folder" itemValue="cmis:folder"/>
                        <f:selectItem itemLabel="Document" itemValue="cmis:document"/>
                    </h:selectOneMenu>

                    <p:commandButton id="savefolderbtn" action="#{cc.foo()}" value="Save" update = "@all" title="Create New Folder">
                        <f:param name ="folderId" value="#{cc.folderId}" />
                    </p:commandButton>

                    <h:commandButton id="savefolderbtn2" actionListener="#{cc.foo()}" value="Save" title="Create New Folder">
                        <f:param name ="folderId" value="#{cc.folderId}" />
                        <f:ajax render = "@all"/>
                    </h:commandButton>
                </h:panelGrid>
            </p:panel>

            <!--<p:button id="save" value="Save" outcome="browser.xhtml?folderId=#{param.folderId}"-->
                      <!--styleClass="ui-priority-primary">-->
                <!--&lt;!&ndash;<f:param name="name"/>&ndash;&gt;-->
                <!--&lt;!&ndash;<f:param type="type"/>&ndash;&gt;-->
            <!--</p:button>-->



            <p:button id="cancel" value="Cancel" outcome="browser.xhtml?folderId=#{param.folderId}"
                      styleClass="ui-priority-primary"/>

        </p:layoutUnit>
    </p:layout>

</cc:implementation>
</ui:composition>